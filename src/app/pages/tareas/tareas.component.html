<div class="tareas-container">
    <div class="container-fluid">
        <!-- Header -->
        <div class="row">
            <div class="col-12">
                <div class="tareas-header">
                    <div class="header-content">
                        <div>
                            <h1 class="page-title">Listado de Tareas</h1>
                            <p class="user-info" *ngIf="usuario">
                                Usuario: <strong>{{ usuario.correo }}</strong>
                            </p>
                        </div>
                        <button
                            mat-raised-button
                            color="warn"
                            (click)="onLogout()"
                            aria-label="Cerrar sesión"
                        >
                            Cerrar Sesión
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="row">
            <div class="col-12 text-center py-5">
                <mat-spinner
                    diameter="50"
                    aria-label="Cargando tareas..."
                ></mat-spinner>
                <p class="mt-3 text-muted">Cargando tareas...</p>
            </div>
        </div>

        <!-- Error State -->
        <div *ngIf="errorMessage && !loading" class="row">
            <div class="col-12">
                <div class="alert alert-danger" role="alert" aria-live="polite">
                    <span class="alert-icon" aria-hidden="true">⚠️</span>
                    {{ errorMessage }}
                    <button
                        mat-button
                        (click)="loadTareas()"
                        class="retry-button"
                        aria-label="Reintentar carga de tareas"
                    >
                        Reintentar
                    </button>
                </div>
            </div>
        </div>

        <!-- Tareas List (JSON format) -->
        <div *ngIf="!loading && !errorMessage" class="row">
            <div class="col-12">
                <div class="tareas-content">
                    <!-- Empty State -->
                    <div *ngIf="tareas.length === 0" class="empty-state">
                        <p class="text-muted">No hay tareas para mostrar</p>
                    </div>

                    <!-- Tareas List -->
                    <div *ngIf="tareas.length > 0" class="tareas-list">
                        <h2 class="list-title">
                            Tareas ({{ tareas.length }})
                        </h2>
                        <div
                            *ngFor="let tarea of tareas; index as i"
                            class="tarea-item"
                            [attr.aria-label]="'Tarea ' + (i + 1)"
                        >
                            <div class="tarea-header">
                                <span class="tarea-number">#{{ i + 1 }}</span>
                                <span
                                    class="tarea-estado"
                                    [class.estado-pendiente]="tarea.estado === 'P'"
                                    [class.estado-completada]="tarea.estado === 'C'"
                                >
                                    {{ tarea.estado === 'P' ? 'Pendiente' : 'Completada' }}
                                </span>
                            </div>
                            <pre class="tarea-json">{{ toJSON(tarea) }}</pre>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
