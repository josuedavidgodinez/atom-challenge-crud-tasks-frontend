<div class="tareas-container">
    <div class="container-fluid">
        <!-- Header -->
        <div class="row">
            <div class="col-12">
                <div class="tareas-header">
                    <div class="header-content">
                        <div class="header-info">
                            <h1 class="page-title">Mis Tareas</h1>
                            <p class="user-info" *ngIf="usuario">
                                <mat-icon class="user-icon">account_circle</mat-icon>
                                {{ usuario.correo }}
                            </p>
                        </div>
                        <div class="header-actions">
                            <button
                                mat-raised-button
                                color="primary"
                                (click)="onCreateTarea()"
                                aria-label="Crear nueva tarea"
                            >
                                <mat-icon>add</mat-icon>
                                Nueva Tarea
                            </button>
                            <button
                                mat-stroked-button
                                color="warn"
                                (click)="onLogout()"
                                aria-label="Cerrar sesión"
                            >
                                <mat-icon>logout</mat-icon>
                                Cerrar Sesión
                            </button>
                        </div>
                    </div>

                    <!-- Stats -->
                    <div class="stats-container" *ngIf="!loading && tareas.length > 0">
                        <div class="stat-item">
                            <mat-icon class="stat-icon">assignment</mat-icon>
                            <div class="stat-content">
                                <span class="stat-value">{{ tareas.length }}</span>
                                <span class="stat-label">Total</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <mat-icon class="stat-icon stat-icon-warning">pending_actions</mat-icon>
                            <div class="stat-content">
                                <span class="stat-value">{{ tareasPendientes }}</span>
                                <span class="stat-label">Pendientes</span>
                            </div>
                        </div>
                        <div class="stat-item">
                            <mat-icon class="stat-icon stat-icon-success">check_circle</mat-icon>
                            <div class="stat-content">
                                <span class="stat-value">{{ tareasCompletadas }}</span>
                                <span class="stat-label">Completadas</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading State -->
        <div *ngIf="loading" class="row">
            <div class="col-12">
                <div class="loading-state">
                    <mat-spinner
                        diameter="50"
                        aria-label="Cargando tareas..."
                    ></mat-spinner>
                    <p class="loading-text">Cargando tareas...</p>
                </div>
            </div>
        </div>

        <!-- Error State -->
        <div *ngIf="errorMessage && !loading" class="row">
            <div class="col-12">
                <div class="alert alert-danger" role="alert" aria-live="polite">
                    <mat-icon class="alert-icon">error</mat-icon>
                    <span class="alert-message">{{ errorMessage }}</span>
                    <button
                        mat-button
                        (click)="loadTareas()"
                        class="retry-button"
                        aria-label="Reintentar carga de tareas"
                    >
                        <mat-icon>refresh</mat-icon>
                        Reintentar
                    </button>
                </div>
            </div>
        </div>

        <!-- Empty State -->
        <div *ngIf="!loading && !errorMessage && tareas.length === 0" class="row">
            <div class="col-12">
                <div class="empty-state">
                    <mat-icon class="empty-icon">assignment_late</mat-icon>
                    <h2 class="empty-title">No tienes tareas</h2>
                    <p class="empty-message">
                        Crea tu primera tarea para comenzar a organizarte
                    </p>
                    <button
                        mat-raised-button
                        color="primary"
                        (click)="onCreateTarea()"
                        aria-label="Crear primera tarea"
                    >
                        <mat-icon>add</mat-icon>
                        Crear Tarea
                    </button>
                </div>
            </div>
        </div>

        <!-- Tareas List -->
        <div *ngIf="!loading && !errorMessage && tareas.length > 0" class="row">
            <div class="col-12">
                <div class="tareas-grid">
                    <app-tarea-card
                        *ngFor="let tarea of tareas; trackBy: trackByTareaId"
                        [tarea]="tarea"
                        (tareaEvent)="onTareaEvent($event)"
                        [attr.data-tarea-id]="tarea.id"
                    ></app-tarea-card>
                </div>
            </div>
        </div>
    </div>
</div>
