<div class="tarea-dialog">
    <h2 mat-dialog-title class="dialog-title">
        <mat-icon class="title-icon">{{
            isEditMode ? 'edit' : 'add_task'
        }}</mat-icon>
        {{ dialogTitle }}
    </h2>

    <mat-dialog-content class="dialog-content">
        <form [formGroup]="tareaForm" class="tarea-form">
            <!-- Campo: Título -->
            <mat-form-field appearance="outline" class="form-field mt-3">
                <mat-label>Título</mat-label>
                <input
                    matInput
                    formControlName="titulo"
                    placeholder="Ej: Completar documentación"
                    maxlength="100"
                    aria-label="Título de la tarea"
                    aria-required="true"
                />
                <mat-icon matPrefix>title</mat-icon>
                <mat-error *ngIf="hasError('titulo', 'required')">
                    {{ getErrorMessage('titulo') }}
                </mat-error>
                <mat-error *ngIf="hasError('titulo', 'minlength')">
                    {{ getErrorMessage('titulo') }}
                </mat-error>
                <mat-error *ngIf="hasError('titulo', 'maxlength')">
                    {{ getErrorMessage('titulo') }}
                </mat-error>
                <mat-hint align="end">
                    {{ tareaForm.get('titulo')?.value?.length || 0 }}/100
                </mat-hint>
            </mat-form-field>

            <!-- Campo: Descripción -->
            <mat-form-field appearance="outline" class="form-field">
                <mat-label>Descripción</mat-label>
                <textarea
                    matInput
                    formControlName="descripcion"
                    placeholder="Describe los detalles de la tarea..."
                    rows="4"
                    maxlength="500"
                    aria-label="Descripción de la tarea"
                    aria-required="true"
                ></textarea>
                <mat-icon matPrefix>description</mat-icon>
                <mat-error *ngIf="hasError('descripcion', 'required')">
                    {{ getErrorMessage('descripcion') }}
                </mat-error>
                <mat-error *ngIf="hasError('descripcion', 'minlength')">
                    {{ getErrorMessage('descripcion') }}
                </mat-error>
                <mat-error *ngIf="hasError('descripcion', 'maxlength')">
                    {{ getErrorMessage('descripcion') }}
                </mat-error>
                <mat-hint align="end">
                    {{ tareaForm.get('descripcion')?.value?.length || 0 }}/500
                </mat-hint>
            </mat-form-field>

            <!-- Campo: Estado -->
            <div class="form-field estado-field">
                <mat-checkbox
                    [checked]="isCompletada"
                    (change)="onToggleEstado()"
                    color="primary"
                    aria-label="Estado de la tarea"
                >
                    <span class="estado-label">
                        {{ isCompletada ? 'Completada' : 'Pendiente' }}
                    </span>
                </mat-checkbox>
            </div>
        </form>
    </mat-dialog-content>

    <mat-dialog-actions class="dialog-actions">
        <div class="actions-left">
            <button
                *ngIf="isEditMode"
                mat-button
                color="warn"
                (click)="onDelete()"
                aria-label="Eliminar tarea"
            >
                <mat-icon>delete</mat-icon>
                Eliminar
            </button>
        </div>

        <div class="actions-right">
            <button
                mat-button
                (click)="onCancel()"
                aria-label="Cancelar"
            >
                Cancelar
            </button>
            <button
                mat-raised-button
                color="primary"
                (click)="onSave()"
                [disabled]="!canSave"
                aria-label="Guardar tarea"
            >
                <mat-icon>save</mat-icon>
                {{ isEditMode ? 'Guardar' : 'Crear' }}
            </button>
        </div>
    </mat-dialog-actions>
</div>
